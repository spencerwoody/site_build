k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
q
alpha <- 0.05
q_star <- 0.1
m0 <- 4
m <- 10
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
q
alpha <- 0.05
q_star <- 0.1
m0 <- 4
m <- 10
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
q
alpha <- 0.05
q_star <- 0.1
m0 <- 4
m <- 10
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
q
alpha <- 0.05
q_star <- 0.1
m0 <- 4
m <- 10
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
q
alpha <- 0.05
q_star <- 0.1
m0 <- 4
m <- 10
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
q
alpha <- 0.05
q_star <- 0.1
m0 <- 4
m <- 10
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
q
alpha <- 0.05
q_star <- 0.1
m0 <- 4
m <- 10
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
q
alpha <- 0.05
q_star <- 0.1
m0 <- 4
m <- 10
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
q
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
library(ggplot2)
library(dplyr)
# Confidence level
alpha <- 0.05
q_star <- 0.1
m0 <- 4
m <- 10
nsims <- 1e4
q_vec <- 1:nsims
for (i in 1:nsims) {
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q_vec[i] <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
}
mean(q_vec)
# Confidence level
alpha <- 0.05
q_star <- 0.3
m0 <- 4
m <- 10
nsims <- 1e4
q_vec <- 1:nsims
for (i in 1:nsims) {
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q_vec[i] <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
}
mean(q_vec)
# Confidence level
alpha <- 0.05
q_star <- 0.3
m0 <- 40
m <- 100
nsims <- 1e4
q_vec <- 1:nsims
for (i in 1:nsims) {
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q_vec[i] <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
}
mean(q_vec)
# Confidence level
alpha <- 0.05
q_star <- 0.3
m0 <- 40
m <- 100
nsims <- 1e4
q_vec <- 1:nsims
for (i in 1:nsims) {
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q_vec[i] <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
}
mean(q_vec)
alpha <- 0.05
q_star <- 0.3
m0 <- 40
m <- 100
nsims <- 1e4
q_vec <- 1:nsims
for (i in 1:nsims) {
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q_vec[i] <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
}
mean(q_vec)
alpha <- 0.05
q_star <- 0.5
m0 <- 40
m <- 100
nsims <- 1e4
q_vec <- 1:nsims
for (i in 1:nsims) {
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q_vec[i] <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
}
mean(q_vec)
alpha <- 0.05
q_star <- 0.1
m0 <- 40
m <- 100
nsims <- 1e4
q_vec <- 1:nsims
for (i in 1:nsims) {
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
p <- 2 * (1 - pnorm(abs(x)))
k_vec <- order(p)
sort_p <- sort(p)
reject_idx <- (sort_p / 1:m) <= (q_star / m)
reject_k <- k_vec[reject_idx]
reject_k
q_vec[i] <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
}
mean(q_vec)
ggplot() +
geom_histogram(aes(q_vec, ..density..), col = "snow", fill = "grey70")
mean(q_vec)
# Target FDR
q_star <- 0.3
# Number of "signals" and number of "noises"
m0 <- 40
m1 <- 60
m <- m0 + m1
# Number of simulations
nsims <- 1e4
# Create an empty vector for proportions of false discoveries
q_vec <- 1:nsims
for (i in 1:nsims) {
x <- rep(NA, m)
x[1:m0] <- rnorm(m0) + 1
x[(m0 + 1):m] <- rnorm(m - m0)
# Vector of p-values
p <- 2 * (1 - pnorm(abs(x)))
# Order of p-values
k_vec <- order(p)
# Sorted p-values
sort_p <- sort(p)
# BH procedure
reject_idx <- { (sort_p / 1:m) <= (q_star / m) }
reject_k <- k_vec[reject_idx]
# Calculate proportion of false discoveries
q_vec[i] <- ifelse(length(reject_k) > 0,
sum(!(reject_k %in% 1:m0)) / sum(reject_idx),
0)
}
mean(q_vec)
ggplot() +
geom_histogram(aes(q_vec, ..density..), col = "snow", fill = "grey70")
install.packages("boxr")
blogdown:::serve_site()
setwd("~/Documents/Professional/Website/site_build")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
bookdown:::mathquill()
